
<div *ngIf="(Sections | async) as SectionsReady; else SectionsnotReady">
  <div fxLayout="column" style="width: 100%; height: 75vh;overflow-y:auto;" >
    <mat-card *ngIf="SectionsReady !== undefined">
    <mat-card-header style="padding:2%; border:solid; background-color:black;color:white;">
      <span style="margin-top:2%;">{{latestProject}} </span>  <mat-chip color="primary" selected style=" cursor: pointer;margin-left:5%;">View Tasks</mat-chip>
    </mat-card-header>
    
      <mat-tree
        [dataSource]="nestedDataSource"
        [treeControl]="nestedTreeControl">

        <!-- Without Children -->
        <mat-nested-tree-node *matTreeNodeDef="let node" >
          <li>
            <div class="mat-tree-node" >
              <button mat-icon-button *ngIf="(node.Description === 'Child' && node.Children.length === 0)">
    
          <mat-icon class="mat-icon-rtl-mirror">
              star
            </mat-icon>
            </button>
            <span style="margin-left:5%;margin-right:5%;">
              {{node.Name}}
            </span>
            <app-delete-node              
              (deletedNode)="deleteNode($event)"
              [currentNode]="node"
            ></app-delete-node>
            <app-edit-node
              (edittedNode)="editNode($event)"
              [masterdata]="nestedDataSource.data"
              [currentNode]="node"
            ></app-edit-node>
            <app-add-node
            [masterdata]="nestedDataSource.data"
               [isTop]="false"
              [latestaddProject]="Project"
              [currentNode]="node"
              [AlltheKeys]="AlltheKeys"
              *ngIf="!(node.Description === 'Child' && node.Children.length === 0)"
            ></app-add-node>
            <mat-chip-list style="margin-right:30px;">

              <mat-chip color="primary" selected *ngIf="(node.Description === 'Child' && node.Children.length === 0)">View Tasks</mat-chip>

            </mat-chip-list>
            </div>
          </li>
        </mat-nested-tree-node>
      
        <!-- With Children -->
        <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">
          <li class="example-tree-container">
            <div class="mat-tree-node">
              <button
                mat-icon-button
                matTreeNodeToggle
                [attr.aria-label]="'toggle ' + node.Name"
              >
                <mat-icon class="mat-icon-rtl-mirror">
                  {{nestedTreeControl.isExpanded(node) ? 'indeterminate_check_box' : 'add_box'}}
                </mat-icon>
              </button>
              <span style="margin-left:5%;margin-right:5%;">
                {{node.Name}}
              </span>
              <app-delete-node              
                (deletedNode)="deleteNode($event)"
                [currentNode]="node"
              ></app-delete-node>
              <app-edit-node
                (edittedNode)="editNode($event)"
                [masterdata]="nestedDataSource.data"
                [currentNode]="node"
              ></app-edit-node>
              <app-add-node
              [masterdata]="nestedDataSource.data"
                [isTop]="false"
                [latestaddProject]="Project"
                [currentNode]="node"
                [AlltheKeys]="AlltheKeys"
              ></app-add-node>
            </div>
            <ul>
              <div *ngIf="nestedTreeControl.isExpanded(node)">    
                <ng-container matTreeNodeOutlet></ng-container>    
              </div>
              <div *ngIf="!nestedTreeControl.isExpanded(node)" style="border:none;">
              </div>
            </ul>
          </li>
        </mat-nested-tree-node>
      </mat-tree>
      <app-add-node
      [masterdata]="nestedDataSource.data"
      [isTop]="true"
      [latestaddProject]="Project"
      [currentNode]="node"
      [AlltheKeys]="AlltheKeys"
      ></app-add-node>

      <button mat-raised-button color="warn" (click)="openBottomSheet()" style="margin:5%;">

        Change Order<mat-icon style="margin-left:5%;">
        add_box
        </mat-icon>
        </button>
        
    </mat-card>
  </div>
</div>
<ng-template #SectionsnotReady>
</ng-template>